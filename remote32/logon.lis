Pro*COBOL: Release 19.0.0.0.0 - Production on Fri Jun 9 14:55:17 2023
Version 19.3.0.0.0

Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.

Open file: /home/oracle/Westpac/remote32/logon.cbl
     1         IDENTIFICATION DIVISION.
     2         PROGRAM-ID. LOGONO.
     3         ENVIRONMENT DIVISION.
     4         DATA DIVISION.
     5         WORKING-STORAGE SECTION.
     6             EXEC SQL BEGIN DECLARE SECTION END-EXEC.
     7         01 USERNAME PIC X(10) VARYING.
     8         01 PASSWD PIC X(10) VARYING.
     9         01 EMP-REC-VARS.
    10           05 EMP-NAME PIC X(10) VARYING.
    11           05 EMP-NUMBER PIC S9(4) COMP VALUE ZERO.
    12           05 SALARY PIC S9(5)V99 COMP-3 VALUE ZERO.
    13           05 COMMISSION PIC S9(5)V99 COMP-3 VALUE ZERO.
    14           05 COMM-IND PIC S9(4) COMP VALUE ZERO.
    15             EXEC SQL END DECLARE SECTION END-EXEC.
    16             EXEC SQL INCLUDE SQLCA END-EXEC.
    17         01 DISPLAY-VARIABLES.
    18           05 D-EMP-NAME PIC X(10).
    19           05 D-SALARY PIC Z(4)9.99.
    20           05 D-COMMISSION PIC Z(4)9.99.
    21         01 D-TOTAL-QUERIED PIC 9(4) VALUE ZERO.
    22         PROCEDURE DIVISION.
    23         BEGIN-PGM SECTION.
    24             CALL "CBL_DEBUGBREAK".
    25             EXEC SQL
    26                 WHENEVER SQLERROR DO PERFORM SQL-ERROR
    27             END-EXEC
    28             .
    29             PERFORM LOGON
    30             .
    31             PERFORM QUERY-LOOP
    32             .
    33             perform SIGN-OFF
    34             .
    35             goback
    36             .
    37  
    38         LOGON SECTION.
    39  
    40             MOVE "mfuser" TO USERNAME-ARR
    41             .
    42             MOVE 5 TO USERNAME-LEN
    43             .
    44             MOVE "Welcome01" TO PASSWD-ARR
    45             .
    46             MOVE 8 TO PASSWD-LEN
    47             .
    48  
    49             EXEC SQL
    50                 CONNECT :USERNAME IDENTIFIED BY :PASSWD
    51             END-EXEC
    52             .
    53  
    54             perform DISPLAY-INFO
    55  
    56             DISPLAY " "
    57             .
    58             DISPLAY "EMPLOYEE    SALARY    COMMISSION"
    59             .
    60             DISPLAY "--------    ------    ----------"
Pro*COBOL: Release 19.0.0.0.0 - Production on Fri Jun 9 14:55:17 2023
Version 19.3.0.0.0

Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.

    61             .
    62             MOVE EMP-NAME-ARR TO D-EMP-NAME
    63             .
    64             MOVE SALARY TO D-SALARY
    65             .
    66             IF COMM-IND = -1
    67                 DISPLAY D-EMP-NAME, D-SALARY, "          NULL"
    68             ELSE
    69                 MOVE COMMISSION TO D-COMMISSION
    70                 DISPLAY D-EMP-NAME, D-SALARY, "      ", D-COMMISSION
    71             END-IF
    72             .
    73  
    74         LOGON-EXIT.
    75             EXIT
    76             .
    77  
    78         QUERY-LOOP SECTION.
    79             DISPLAY " "
    80             .
    81             DISPLAY "ENTER EMP NUMBER (0 TO QUIT): " WITH NO ADVANCING
    82             .
    83             ACCEPT EMP-NUMBER
    84             IF (EMP-NUMBER = 0)
    85                 PERFORM SIGN-OFF
    86             .
    87  
    88             MOVE SPACES TO EMP-NAME-ARR
    89             .
    90             EXEC SQL
    91                 WHENEVER NOT FOUND GOTO NO-EMP
    92             END-EXEC
    93             .
    94  
    95             EXEC SQL
    96                 SELECT ENAME, SAL, COMM
    97                 INTO :EMP-NAME, :SALARY, :COMMISSION:COMM-IND
    98                 FROM EMP
    99                 WHERE EMPNO = :EMP-NUMBER
   100             END-EXEC
   101             .
   102  
   103             PERFORM DISPLAY-INFO
   104             .
   105             ADD 1 TO D-TOTAL-QUERIED
   106             .
   107  
   108         NO-EMP SECTION.
   109             DISPLAY "NOT A VALID EMPLOYEE NUMBER - TRY AGAIN."
   110             .
   111         NO-EMP-EXIT.
   112             exit
   113             .
   114  
   115         SIGN-OFF SECTION.
   116             DISPLAY " "
   117             .
   118  
   119             DISPLAY "TOTAL NUMBER QUERIED WAS ", D-TOTAL-QUERIED, "."
   120             .
   121             DISPLAY "HAVE A GOOD DAY."
Pro*COBOL: Release 19.0.0.0.0 - Production on Fri Jun 9 14:55:17 2023
Version 19.3.0.0.0

Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.

   122             .
   123             DISPLAY " "
   124             .
   125             EXEC SQL
   126                 COMMIT WORK RELEASE
   127             END-EXEC
   128             .
   129             STOP RUN
   130             .
   131  
   132         SQL-ERROR SECTION.
   133             EXEC SQL
   134                 WHENEVER SQLERROR CONTINUE
   135             END-EXEC
   136             .
   137             DISPLAY " "
   138             .
   139             DISPLAY "ORACLE ERROR DETECTED:"
   140             .
   141             DISPLAY " "
   142             .
   143             DISPLAY SQLERRMC
   144             .
   145             EXEC SQL
   146                 ROLLBACK WORK RELEASE
   147             END-EXEC
   148             .
   149             STOP RUN
   150             .
   151  
   152         DISPLAY-INFO SECTION.
   153  
   154             DISPLAY " " upon console
   155             .
   156             DISPLAY "CONNECTED TO ORACLE AS USER    = " USERNAME upon
   157               console
   158             .
   159             DISPLAY "CONNECTED TO ORACLE AS PASSWORD=" PASSWD upon
   160               console
   161             .
   162             Display "SQLCODE = " SQLCODE
   163             .
   164         DISPLAY-INFO-EXIT.
   165             EXIT
   166             .
Close file: /home/oracle/Westpac/remote32/logon.cbl
Pro*COBOL: Release 19.0.0.0.0 - Production on Fri Jun 9 14:55:17 2023
Version 19.3.0.0.0

Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.


Host Variables
--------------

05  COMM-IND OF EMP-REC-VARS                            Short Integer
  /home/oracle/Westpac/remote32/logon.cbl        14        97

05  COMMISSION OF EMP-REC-VARS                          Decimal(7,2)
  /home/oracle/Westpac/remote32/logon.cbl        13        97

05  EMP-NAME OF EMP-REC-VARS                            Varchar(10)
  /home/oracle/Westpac/remote32/logon.cbl        10        97        97

05  EMP-NUMBER OF EMP-REC-VARS                          Short Integer
  /home/oracle/Westpac/remote32/logon.cbl        11        99

01  PASSWD                                              Varchar(10)
  /home/oracle/Westpac/remote32/logon.cbl         8        50        50

05  SALARY OF EMP-REC-VARS                              Decimal(7,2)
  /home/oracle/Westpac/remote32/logon.cbl        12        97

01  USERNAME                                            Varchar(10)
  /home/oracle/Westpac/remote32/logon.cbl         7        50        50

Pro*COBOL: Release 19.0.0.0.0 - Production on Fri Jun 9 14:55:17 2023
Version 19.3.0.0.0

Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.


SQL Identifiers
---------------

BIT64                 DEFINE                        Command Line

COMP5                 DEFINE                        Command Line

UNIX                  DEFINE                        Pre-defined

Pro*COBOL: Release 19.0.0.0.0 - Production on Fri Jun 9 14:55:17 2023
Version 19.3.0.0.0

Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.



                              Precompiler Options
-------------------------------------------------------------------------------
Option Name    Current Value        Where set
-------------------------------------------------------------------------------
asacc             no                default                                     
assume_sqlcode    no                default                                     
auto_connect      no                default                                     
charset_picn      nchar_charset     default                                     
charset_picx      db_charset        default                                     
close_on_commit   no                default                                     
common_parser     no                default                                     
comp5             yes               /opt/oracle/product/19c/dbhome_1/precomp/adm
config            default config    default                                     
cwh_sql99         yes               default                                     
date_format       local             default                                     
db2_array         no                default                                     
dbms              native            default                                     
declare_section   no                default                                     
define            COMP5             /opt/oracle/product/19c/dbhome_1/precomp/adm
                  BIT64             /opt/oracle/product/19c/dbhome_1/precomp/adm
                  *none*            /opt/oracle/product/19c/dbhome_1/precomp/adm
dynamic           oracle            default                                     
end_of_fetch      1403              default                                     
errors            yes               default                                     
file_id           0                 default                                     
fips              no                default                                     
format            ansi              default                                     
hold_cursor       no                default                                     
host              cobol             default                                     
implicit_svpt     no                default                                     
iname             /home/oracle/Westpcommand linelogon.cbl                       
include           *none*            default                                     
ireclen           80                default                                     
litdelim          quote             default                                     
lname             /home/oracle/Westpcommand linelogon.lis                       
lreclen           132               default                                     
ltype             long              default                                     
maxliteral        256               default                                     
maxopencursors    10                default                                     
max_row_insert    0                 default                                     
memforprefetch    0                 default                                     
mode              oracle            default                                     
nested            yes               default                                     
nls_local         no                default                                     
oname             /home/oracle/Westpcommand linelogon.cs9                       
oraca             no                default                                     
oreclen           80                default                                     
outline           no                default                                     
outlnprefix       *none*            default                                     
pagelen           66                default                                     
picn_endian       big               default                                     
picx              charf             default                                     
plan_baseline     no                default                                     
plan_enabled      yes               default                                     
plan_fixed        yes               default                                     
plan_prefix       none              default                                     
plan_run          no                default                                     
prefetch          1                 default                                     
release_cursor    no                default                                     
runoutline        no                default                                     
select_error      yes               default                                     
sqlcheck          syntax            default                                     
stmt_cache        0                 default                                     
threads           no                default                                     
trim_password     no                default                                     
type_code         oracle            default                                     
unsafe_null       no                default                                     
userid            *none*            default                                     
varchar           no                default                                     
xref              yes               default                                     
Pro*COBOL: Release 19.0.0.0.0 - Production on Fri Jun 9 14:55:17 2023
Version 19.3.0.0.0

Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.


Statistics
----------

Return code: 0
Number of messages at severity I: 0
Number of messages at severity W: 0
Number of messages at severity E: 0
Number of messages at severity F: 0
Number of input lines: 166
Number of host variables declared: 13
Number of cursor names: 0
Number of statement names: 0
Maximum memory (bytes) used: 1012675
