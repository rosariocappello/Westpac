* Micro Focus COBOL                  V8.0 revision 000 19-Jun-23 20:55 Page   1
* /home/oracle/Westpac/prod/cobol/logon.cob
* Options: int("logon.int") verbose
*          use(/home/oracle/Westpac/prod/dir/logon.cob.dir)
*          INT(/home/oracle/Westpac/prod/bin/)
*          LIST(/home/oracle/Westpac/prod/listing/logon.lst)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. LOGON.
     3 ENVIRONMENT DIVISION.
     4 DATA DIVISION.
     5 WORKING-STORAGE SECTION.
     6     EXEC SQL BEGIN DECLARE SECTION END-EXEC.
     7 01 USERNAME PIC X(10) varying.
     8 01 PASSWD PIC X(10) varying.
     9 01 EMP-REC-VARS.
    10   05 EMP-NAME PIC X(10) VARYING.
    11   05 EMP-NUMBER PIC S9(4) COMP VALUE ZERO.
    12   05 SALARY PIC S9(5)V99 COMP-3 VALUE ZERO.
    13   05 COMMISSION PIC S9(5)V99 COMP-3 VALUE ZERO.
    14   05 COMM-IND PIC S9(4) COMP VALUE ZERO.
    15     EXEC SQL END DECLARE SECTION END-EXEC.
    16     EXEC SQL INCLUDE SQLCA END-EXEC.
    17
    18 01 DISPLAY-VARIABLES.
    19   05 D-EMP-NAME PIC X(10).
    20   05 D-SALARY PIC Z(4)9.99.
    21   05 D-COMMISSION PIC Z(4)9.99.
    22
    23 01 D-TOTAL-QUERIED PIC 9(4) VALUE ZERO.
    24
    25 01 ws-flags pic x(4) comp-5 value 1.
    26 01 ws-timeout pic s9(18) comp-5 value 0.
    27 01 ws-identifier PIC x(4) VALUE "HELP".
    28 01 ws-status-code pic x(4) comp-5 value zero.
    29
    30 PROCEDURE DIVISION.
    31 BEGIN-PGM SECTION.
    32
    33     CALL"CBL_DEBUG_START" using  by value ws-flags
    34                                         ws-timeout
    35                        by reference     ws-identifier
    36                        returning        ws-status-code
    37
    38     ACCEPT EMP-NUMBER
    39     EXEC SQL
    40         WHENEVER SQLERROR DO PERFORM SQL-ERROR
    41     END-EXEC
    42     .
    43     PERFORM LOGON
    44     .
    45     PERFORM QUERY-LOOP
    46     .
    47     perform SIGN-OFF
    48     .
    49     goback
    50     .
    51
    52 LOGON SECTION.
    53
    54     MOVE "mfuser" TO USERNAME-ARR
* Micro Focus COBOL                  V8.0 revision 000 19-Jun-23 20:55 Page   2
* /home/oracle/Westpac/prod/cobol/logon.cob
    55     .
    56     MOVE 6 TO USERNAME-LEN
    57     .
    58     MOVE "Welcome01" TO PASSWD-ARR
    59
    60     MOVE 9 TO PASSWD-LEN
    61     .
    62
    63     EXEC SQL
    64         CONNECT :USERNAME IDENTIFIED BY :PASSWD
    65     END-EXEC
    66     .
    67     perform DISPLAY-INFO
    68
    69     DISPLAY " "
    70     .
    71     DISPLAY "EMPLOYEE    SALARY    COMMISSION" upon console
    72     .
    73     DISPLAY "--------    ------    ----------" upon console
    74     .
    75
    76 LOGON-EXIT.
    77     EXIT
    78     .
    79
    80 QUERY-LOOP SECTION.
    81     DISPLAY " "  upon console
    82     .
    83     DISPLAY "ENTER EMP NUMBER (0 TO QUIT): "  upon console
    84     .
    85
    86     ACCEPT EMP-NUMBER
    87     IF (EMP-NUMBER = 0)
    88         PERFORM SIGN-OFF
    89     END-IF
    90     .
    91
    92     perform until EMP-NUMBER = 0
    93
    94         perform get-employee-info
    95         DISPLAY " "  upon console
    96         DISPLAY "ENTER EMP NUMBER (0 TO QUIT): "   upon console
    97         ACCEPT EMP-NUMBER
    98
    99     end-perform.
   100
   101 QUERY-LOOP-exit.
   102       exit.
   103     .
   104
   105 get-employee-info section.
   106
   107     MOVE SPACES TO EMP-NAME-ARR
   108     .
   109
   110     .
   111
   112      EXEC SQL
* Micro Focus COBOL                  V8.0 revision 000 19-Jun-23 20:55 Page   3
* /home/oracle/Westpac/prod/cobol/logon.cob
   113         SELECT ENAME, SAL, COMM
   114         INTO :EMP-NAME, :SALARY, :COMMISSION:COMM-IND
   115         FROM EMP
   116         WHERE EMPNO = :EMP-NUMBER
   117      END-EXEC
   118     .
   119     if sqlcode = 0
   120         PERFORM DISPLAY-LINE
   121     else
   122         DISPLAY "NOT A VALID EMPLOYEE NUMBER - TRY AGAIN."
   123     end-if
   124     .
   125     ADD 1 TO D-TOTAL-QUERIED.
   126
   127 get-employee-info-EXIT.
   128     EXIT
   129     .
   130
   131 SIGN-OFF SECTION.
   132     DISPLAY " "
   133     .
   134
   135     DISPLAY "TOTAL NUMBER QUERIED WAS ", D-TOTAL-QUERIED, "."
   136     .
   137     DISPLAY "HAVE A GOOD DAY."
   138     .
   139     DISPLAY " "
   140     .
   141     EXEC SQL
   142         COMMIT WORK RELEASE
   143     END-EXEC
   144     .
   145     GOBACK.
   146     .
   147
   148 SQL-ERROR SECTION.
   149     EXEC SQL
   150         WHENEVER SQLERROR CONTINUE
   151     END-EXEC
   152     .
   153     DISPLAY " "
   154     .
   155     DISPLAY "ORACLE ERROR DETECTED:"
   156     .
   157     DISPLAY " "
   158     .
   159     DISPLAY SQLERRMC
   160     .
   161     EXEC SQL
   162         ROLLBACK WORK RELEASE
   163     END-EXEC
   164     .
   165     STOP RUN
   166     .
   167
   168 DISPLAY-INFO SECTION.
   169
   170     DISPLAY " " upon console
* Micro Focus COBOL                  V8.0 revision 000 19-Jun-23 20:55 Page   4
* /home/oracle/Westpac/prod/cobol/logon.cob
   171     .
   172     DISPLAY "CONNECTED TO ORACLE AS USER    = " USERNAME upon
   173       console
   174     .
   175     DISPLAY "CONNECTED TO ORACLE AS PASSWORD=" PASSWD upon
   176       console
   177     .
   178     Display "SQLCODE = " SQLCODE
   179     .
   180 DISPLAY-INFO-EXIT.
   181     EXIT
   182     .
   183
   184 DISPLAY-LINE SECTION.
   185
   186     MOVE EMP-NAME-ARR TO D-EMP-NAME
   187     .
   188     MOVE SALARY TO D-SALARY
   189     .
   190     IF COMM-IND = -1
   191         DISPLAY D-EMP-NAME, D-SALARY, "          NULL"
   192     ELSE
   193         MOVE COMMISSION TO D-COMMISSION
   194         DISPLAY D-EMP-NAME, D-SALARY, "      ", D-COMMISSION
   195     END-IF
   196     .
   197     .
   198 DISPLAY-LINE-EXIT.
   199     EXIT
   200     .
   200*Host Variables
   200*--------------
   200*05  COMM-IND OF EMP-REC-VARS                            Short Integer
   200*  /home/oracle/Westpac/prod/cobol/logon.cob        14       114
   200*05  COMMISSION OF EMP-REC-VARS                          Decimal(7,2)
   200*  /home/oracle/Westpac/prod/cobol/logon.cob        13       114
   200*05  EMP-NAME OF EMP-REC-VARS                            Varchar(10)
   200*  /home/oracle/Westpac/prod/cobol/logon.cob        10       114       114
   200*05  EMP-NUMBER OF EMP-REC-VARS                          Short Integer
   200*  /home/oracle/Westpac/prod/cobol/logon.cob        11       116
   200*01  PASSWD                                              Varchar(10)
   200*  /home/oracle/Westpac/prod/cobol/logon.cob         8        64        64
   200*05  SALARY OF EMP-REC-VARS                              Decimal(7,2)
   200*  /home/oracle/Westpac/prod/cobol/logon.cob        12       114
   200*01  USERNAME                                            Varchar(10)
   200*  /home/oracle/Westpac/prod/cobol/logon.cob         7        64        64
   200*Version 19.3.0.0.0
   200*Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reser
   200*SQL Identifiers
   200*---------------
   200*BIT64                 DEFINE                        Command Line
   200*COMP5                 DEFINE                        Command Line
   200*UNIX                  DEFINE                        Pre-defined
   200*Version 19.3.0.0.0
   200*Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reser
   200*                              Precompiler Options
   200*-------------------------------------------------------------------------
   200*Option Name    Current Value        Where set
* Micro Focus COBOL                  V8.0 revision 000 19-Jun-23 20:55 Page   5
* /home/oracle/Westpac/prod/cobol/logon.cob
   200*-------------------------------------------------------------------------
   200*asacc             no                default
   200*assume_sqlcode    no                default
   200*auto_connect      no                default
   200*charset_picn      nchar_charset     default
   200*charset_picx      db_charset        default
   200*close_on_commit   no                default
   200*common_parser     no                default
   200*comp5             yes               /opt/oracle/product/19c/dbhome_1/prec
   200*config            default config    default
   200*cwh_sql99         yes               default
   200*date_format       local             default
   200*db2_array         no                default
   200*dbms              native            default
   200*declare_section   no                default
   200*define            COMP5             /opt/oracle/product/19c/dbhome_1/prec
   200*                  BIT64             /opt/oracle/product/19c/dbhome_1/prec
   200*                  *none*            /opt/oracle/product/19c/dbhome_1/prec
   200*dynamic           oracle            default
   200*end_of_fetch      1403              default
   200*errors            yes               default
   200*file_id           0                 default
   200*fips              no                default
   200*format            ansi              default
   200*hold_cursor       no                default
   200*host              cobol             default
   200*implicit_svpt     no                default
   200*iname             /home/oracle/Westpcommand linel/logon.cob
   200*include           *none*            default
   200*ireclen           80                default
   200*litdelim          quote             default
   200*lname             /home/oracle/Westpcommand linel/logon.lis
   200*lreclen           132               default
   200*ltype             long              default
   200*maxliteral        256               default
   200*maxopencursors    10                default
   200*max_row_insert    0                 default
   200*memforprefetch    0                 default
   200*mode              oracle            default
   200*nested            yes               default
   200*nls_local         no                default
   200*oname             /home/oracle/Westpcommand linel/logon.cs9
   200*oraca             no                default
   200*oreclen           80                default
   200*outline           no                default
   200*outlnprefix       *none*            default
   200*pagelen           66                default
   200*picn_endian       big               default
   200*picx              charf             default
   200*plan_baseline     no                default
   200*plan_enabled      yes               default
   200*plan_fixed        yes               default
   200*plan_prefix       none              default
   200*plan_run          no                default
   200*prefetch          1                 default
   200*release_cursor    no                default
   200*runoutline        no                default
   200*select_error      yes               default
* Micro Focus COBOL                  V8.0 revision 000 19-Jun-23 20:55 Page   6
* /home/oracle/Westpac/prod/cobol/logon.cob
   200*sqlcheck          syntax            default
   200*stmt_cache        0                 default
   200*threads           no                default
   200*trim_password     no                default
   200*type_code         oracle            default
   200*unsafe_null       no                default
   200*userid            *none*            default
   200*varchar           no                default
   200*xref              yes               default
   200*Version 19.3.0.0.0
   200*Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reser
   200*Statistics
   200*----------
   200*Return code: 0
   200*Number of messages at severity I: 0
   200*Number of messages at severity W: 0
   200*Number of messages at severity E: 0
   200*Number of messages at severity F: 0
   200*Number of input lines: 200
   200*Number of host variables declared: 17
   200*Number of cursor names: 0
   200*Number of statement names: 0
   200*Maximum memory (bytes) used: 1018779
* Micro Focus COBOL                  V8.0 revision 000 Compiler
* (C) Copyright 1984-2023 Micro Focus or one of its affiliates.
*                                                        REF GNR-085800000AM
* Total Messages:     0
* Data:        1760     Code:        3195
